<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸŸï¸ Super Rifa de una Xtz 150 y una eco deluxe 0k</title>

<style>
body{font-family:Arial,sans-serif;background:#f2f2f2;margin:0;padding:15px}
h1,h2{text-align:center}
.hero,.card{
  background:#fff;
  padding:16px;
  border-radius:12px;
  margin-bottom:16px;
  box-shadow:0 4px 10px rgba(0,0,0,.08)
}
.hero img{width:100%;border-radius:12px;margin-bottom:10px}
button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border:none;
  border-radius:8px;
  background:#4CAF50;
  color:white;
  font-size:16px;
  cursor:pointer
}
button.secondary{background:#2196F3}
input{width:100%;padding:10px;margin-top:6px;font-size:15px}
.packages{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:10px
}
.resultado{
  margin-top:10px;
  font-size:14px;
  background:#f7f7f7;
  padding:10px;
  border-radius:8px;
}

/* ğŸ”¥ MODAL CENTRADO */
.modal{
  display:none;
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,.6);
  align-items:center;
  justify-content:center;
  z-index:999;
}
.modal-box{
  background:#fff;
  width:90%;
  max-width:360px;
  padding:22px;
  border-radius:14px;
  text-align:center;
}
.footer{
  background:#1f2933;
  color:#e5e7eb;
  margin-top:30px;
  padding:22px 15px;
  border-top:4px solid #4CAF50;
}

.footer-content{
  max-width:420px;
  margin:auto;
  text-align:center;
  font-size:13.5px;
  line-height:1.6;
}

.footer-content p{
  margin:6px 0;
}

.footer-copy{
  margin-top:12px;
  font-size:12px;
  color:#9ca3af;
}
</style>
</head>

<body>

<div class="hero">
  <img id="slide" src="img/Foto1.jpg" alt="Rifa">
  <h1>ğŸŸï¸ GRAN RIFA OFICIAL</h1>
  <p>Muy pronto todo esto serÃ¡ tuyo, no dejes perder esta oportunidad</p>
</div>

<div class="card">
  <h2>ğŸ“¦ Paquetes</h2>
  <div class="packages">
    <button onclick="elegir(10)">10 nÃºmeros<br>$50.000</button>
    <button onclick="elegir(20)">20 nÃºmeros<br>$100.000</button>
    <button onclick="elegir(50)">50 nÃºmeros<br>$250.000</button>
    <button onclick="elegir(100)">100 nÃºmeros<br>$500.000</button>
    <button onclick="elegir(150)">150 nÃºmeros<br>$750.000</button>
  </div>
</div>

<div class="card">
  <h2>âœï¸ Personalizado</h2>
  <input type="number" id="cantidad" min="10" placeholder="MÃ­nimo 10 nÃºmeros">
  <button onclick="personalizado()">Continuar</button>
</div>

<!-- ğŸ”¥ MODAL OPCIONES -->
<div class="modal" id="modalOpciones">
  <div class="modal-box">
    <h2>ğŸ¯ Â¿CÃ³mo quieres tus nÃºmeros?</h2>
    <button class="secondary" onclick="azar()">ğŸ² Al azar</button>
    <button onclick="seleccionar()">âœ‹ Seleccionar</button>
  </div>
</div>

<div class="card">
  <h2>ğŸ” Buscar mis nÃºmeros</h2>
  <input type="email" id="correoBuscar" placeholder="Ingresa tu correo">
  <button class="secondary" onclick="buscarPorCorreo()">Buscar</button>
  <div id="resultado" class="resultado"></div>
</div>

<!-- ğŸ”¥ FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBMKX5fQXRZP-Ic0_Z6yWqD0LBWSn6H2t4",
  authDomain: "rifa-2026-1a341.firebaseapp.com",
  projectId: "rifa-2026-1a341"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.db = db;
window.collection = collection;
window.query = query;
window.where = where;
window.getDocs = getDocs;

window.buscarPorCorreo = async function(){
  const correo = correoBuscar.value.trim();
  const res = resultado;

  if(!correo){
    res.innerHTML = "âŒ Ingresa un correo vÃ¡lido";
    return;
  }

  const q = query(collection(db,"compras"), where("correo","==",correo));
  const snap = await getDocs(q);

  if(snap.empty){
    res.innerHTML = "âŒ No se encontraron compras";
    return;
  }

  let html = "";
  snap.forEach(d=>{
    const c = d.data();
    html += `
      ğŸŸ ${c.numeros.join(", ")}<br>
      ğŸ’° $${c.total.toLocaleString()}<br>
      ğŸ“Œ ${c.estado}<hr>
    `;
  });

  res.innerHTML = html;
};
</script>

<script>
const fotos=["Foto1.JPG","Foto2.JPG","Foto3.JPG","Foto4.JPG"];
let i=0;
setInterval(()=>{
  i=(i+1)%fotos.length;
  slide.src=fotos[i];
},3000);

let cantidad=0;
const PRECIO=5000;
const TOTAL=10000;

function elegir(c){
  cantidad=c;
  abrirModal();
}

function personalizado(){
  const c = Number(document.getElementById("cantidad").value);
  if(c < 10){
    alert("MÃ­nimo 10 nÃºmeros");
    return;
  }
  cantidad=c;
  abrirModal();
}

function abrirModal(){
  document.getElementById("modalOpciones").style.display="flex";
}
function cerrarModal(){
  document.getElementById("modalOpciones").style.display="none";
}

// ğŸ² AL AZAR
async function azar(){
  cerrarModal();

  const bloqueados=new Set();
  const q=query(collection(db,"compras"),where("estado","in",["pendiente","confirmado"]));
  const snap=await getDocs(q);

  snap.forEach(d=>{
    const c=d.data();
    if(Array.isArray(c.numeros)) c.numeros.forEach(n=>bloqueados.add(n));
  });

  const libres=[];
  for(let i=0;i<TOTAL;i++){
    const n=i.toString().padStart(4,"0");
    if(!bloqueados.has(n)) libres.push(n);
  }

  if(libres.length<cantidad){
    alert("âŒ No hay suficientes nÃºmeros disponibles");
    return;
  }

  const seleccion=[];
  while(seleccion.length<cantidad){
    const r=libres[Math.floor(Math.random()*libres.length)];
    if(!seleccion.includes(r)) seleccion.push(r);
  }

  localStorage.setItem("numeros",JSON.stringify(seleccion));
  localStorage.setItem("cantidad",cantidad);
  localStorage.setItem("total",cantidad*PRECIO);
  location.href="checkout.html";
}

function seleccionar(){
  cerrarModal();
  localStorage.setItem("cantidad",cantidad);
  location.href="seleccionar.html";
}
</script>
<footer class="footer">
  <div class="footer-content">
    <p>ğŸŸï¸ <b>Rifa privada</b></p>
    <p>
      ğŸ”’ Los nÃºmeros se reservan temporalmente y se asignan por orden de confirmaciÃ³n del pago.<br>
      â³ La validaciÃ³n del pago es <b>manual</b>.<br>
      ğŸ“§ La confirmaciÃ³n se envÃ­a por <b>correo electrÃ³nico y WhatsApp</b>.
    </p>
    <p class="footer-copy">
      Â© 2026 Â· Todos los derechos reservados
    </p>
  </div>
</footer>
</body>
</html>
