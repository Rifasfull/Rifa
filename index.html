<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸŸï¸ Rifa Oficial</title>

<style>
body{
  font-family:Arial,sans-serif;
  background:#f2f2f2;
  margin:0;
  padding:15px
}
h1,h2{text-align:center}
.hero,.card{
  background:#fff;
  padding:16px;
  border-radius:12px;
  margin-bottom:16px;
  box-shadow:0 4px 10px rgba(0,0,0,.08)
}
.hero img{
  width:100%;
  border-radius:12px;
  margin-bottom:10px;
}
button{
  width:100%;
  padding:12px;
  margin-top:10px;
  border:none;
  border-radius:8px;
  background:#4CAF50;
  color:white;
  font-size:16px;
  cursor:pointer
}
button.secondary{background:#2196F3}
input{
  width:100%;
  padding:10px;
  margin-top:6px;
  font-size:15px
}
.packages{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:10px
}
.resultado{
  margin-top:10px;
  font-size:14px;
  background:#f7f7f7;
  padding:10px;
  border-radius:8px;
}
</style>
</head>

<body>

<!-- ğŸï¸ CARRUSEL -->
<div class="hero">
  <img id="slide" src="img/Foto1.jpg" alt="Rifa">
  <h1>ğŸŸï¸ GRAN RIFA OFICIAL</h1>
  <p>Entre mÃ¡s nÃºmeros tengas, mÃ¡s oportunidades de ganar</p>
</div>

<div class="card">
  <h2>ğŸ“¦ Paquetes</h2>
  <div class="packages">
    <button onclick="elegir(10)">10 nÃºmeros<br>$50.000</button>
    <button onclick="elegir(20)">20 nÃºmeros<br>$100.000</button>
    <button onclick="elegir(50)">50 nÃºmeros<br>$250.000</button>
    <button onclick="elegir(100)">100 nÃºmeros<br>$500.000</button>
    <button onclick="elegir(150)">150 nÃºmeros<br>$750.000</button>
  </div>
</div>

<div class="card">
  <h2>âœï¸ Personalizado</h2>
  <input type="number" id="cantidad" min="10" placeholder="MÃ­nimo 10 nÃºmeros">
  <button onclick="personalizado()">Continuar</button>
</div>

<div class="card" id="opciones" style="display:none">
  <h2>Â¿CÃ³mo quieres tus nÃºmeros?</h2>
  <button class="secondary" onclick="azar()">ğŸ² Al azar</button>
  <button onclick="seleccionar()">âœ‹ Seleccionar</button>
</div>

<!-- ğŸ” BUSCAR POR CORREO -->
<div class="card">
  <h2>ğŸ” Buscar mis nÃºmeros</h2>
  <input type="email" id="correoBuscar" placeholder="Ingresa tu correo">
  <button class="secondary" onclick="buscarPorCorreo()">Buscar</button>
  <div id="resultado" class="resultado"></div>
</div>

<!-- ğŸ”¥ FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBMKX5fQXRZP-Ic0_Z6yWqD0LBWSn6H2t4",
  authDomain: "rifa-2026-1a341.firebaseapp.com",
  projectId: "rifa-2026-1a341"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.buscarPorCorreo = async function(){
  const correo = document.getElementById("correoBuscar").value.trim();
  const res = document.getElementById("resultado");

  if(!correo){
    res.innerHTML = "âŒ Ingresa un correo vÃ¡lido";
    return;
  }

  const q = query(collection(db,"compras"), where("correo","==",correo));
  const snap = await getDocs(q);

  if(snap.empty){
    res.innerHTML = "âŒ No se encontraron compras con ese correo";
    return;
  }

  let html = "";
  snap.forEach(d=>{
    const c = d.data();
    html += `
      ğŸŸ <b>${c.numeros.join(", ")}</b><br>
      ğŸ’° $${c.total.toLocaleString()}<br>
      ğŸ“Œ Estado: ${c.estado}<hr>
    `;
  });

  res.innerHTML = html;
};
</script>

<script>
/* ğŸï¸ CARRUSEL */
const fotos = [
  "img/Foto1.JPG",
  "img/Foto2.JPG",
  "img/Foto3.JPG",
  "img/Foto4.JPG"
];
let i = 0;
setInterval(()=>{
  i = (i+1) % fotos.length;
  document.getElementById("slide").src = fotos[i];
},3000);

/* ğŸŸï¸ LÃ“GICA COMPRA */
let cantidad = 0;
const PRECIO = 5000;

function elegir(c){
  cantidad = c;
  mostrarOpciones();
}

function personalizado(){
  const c = Number(document.getElementById("cantidad").value);
  if(c < 10){
    alert("Compra mÃ­nima: 10 nÃºmeros");
    return;
  }
  cantidad = c;
  mostrarOpciones();
}

function mostrarOpciones(){
  document.getElementById("opciones").style.display="block";
  document.getElementById("opciones").scrollIntoView({behavior:"smooth"});
}

function azar(){
  const numeros = [];
  while(numeros.length < cantidad){
    const n = Math.floor(Math.random()*10000).toString().padStart(4,"0");
    if(!numeros.includes(n)) numeros.push(n);
  }
  localStorage.setItem("numeros", JSON.stringify(numeros));
  localStorage.setItem("cantidad", cantidad);
  localStorage.setItem("total", cantidad * PRECIO);
  window.location.href="checkout.html";
}

function seleccionar(){
  localStorage.setItem("cantidad", cantidad);
  window.location.href="seleccionar.html";
}
</script>

</body>
</html>
